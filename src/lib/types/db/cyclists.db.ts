import type { Tables } from '../database.types';
import type {
	RaceCategoryDB,
	RaceCategoryGenderDB,
	RaceCategoryLengthDB,
	RaceRankingDB
} from './lookup-tables.db';
import type { EventDB } from './events.db';
import type { RankingPointDB } from './ranking-points.db';

/**
 * Database type for cyclists table.
 * Use this instead of Tables<'cyclists'> throughout the codebase.
 */
export type CyclistDB = Tables<'cyclists'>;

/**
 * Insert type for cyclists table with short_id as optional.
 * short_id is auto-generated by database trigger, so it should be omitted from inserts.
 */
export type CyclistInsert = Omit<CyclistDB, 'id' | 'short_id' | 'created_at' | 'updated_at'> & {
	id?: string;
	short_id?: string;
	created_at?: string | null;
	updated_at?: string | null;
};

/**
 * Type for race result item in RPC responses.
 * Used by get_race_results_by_user_short_id RPC function.
 */
export interface RaceResultRpcItem {
	id: string; // UUID
	short_id: string; // NanoID
	place: number;
	time: string | null;
	cyclist_id: string;
	race_id: string;
	ranking_point_id: string | null;
	created_at: string;
	updated_at: string;
	race: {
		id: string; // UUID
		short_id: string; // NanoID
		name: string | null;
		description: string | null;
		date_time: string;
		is_public_visible: boolean;
		event_id: string;
		race_category_id: string;
		race_category_gender_id: string;
		race_category_length_id: string;
		race_ranking_id: string;
		created_at: string;
		updated_at: string;
		event: EventDB;
		race_category: RaceCategoryDB;
		race_category_gender: RaceCategoryGenderDB;
		race_category_length: RaceCategoryLengthDB;
		race_ranking: RaceRankingDB;
	};
	ranking_point: RankingPointDB | null;
}
